import React from 'react';
import { motion } from 'framer-motion';
import { 
  Box, 
  Typography, 
  Paper,
  Grid,
  Stack,
  useTheme
} from '@mui/material';
import Slide from '@/components/core/Slide';

// Motion components
const MotionBox = motion(Box);
const MotionPaper = motion(Paper);

// Animation variants
const fadeIn = {
  hidden: { opacity: 0 },
  visible: { 
    opacity: 1,
    transition: { duration: 0.5 }
  }
};

const slideUp = {
  hidden: { y: 20, opacity: 0 },
  visible: (custom: number) => ({
    y: 0,
    opacity: 1,
    transition: { 
      delay: custom * 0.1,
      duration: 0.5 
    }
  })
};

// Helper component for HGridLine
const HGridLine = ({ top }: { top: string }) => {
  const theme = useTheme();
  return (
    <Box 
      sx={{ 
        position: 'absolute',
        left: 0,
        right: 0,
        height: '1px',
        backgroundColor: 'divider',
        top: top
      }}
    />
  );
};

// Helper component for VGridLine
const VGridLine = ({ left }: { left: string }) => {
  const theme = useTheme();
  return (
    <Box 
      sx={{ 
        position: 'absolute',
        top: 0,
        bottom: 0,
        width: '1px',
        backgroundColor: 'divider',
        left: left
      }}
    />
  );
};

const CompetitiveLandscape: React.FC = () => {
  const theme = useTheme();
  
  const competitors = [
    { 
      id: "us", 
      name: "Our Solution", 
      x: 0.85, 
      y: 0.85, 
      key_advantages: [
        "Dual market approach (defense & commercial)",
        "Blockchain verification for authenticity",
        "Mobile-first user experience",
        "Military-grade security & compliance"
      ],
      color: theme.palette.primary.main 
    },
    { 
      id: "comp1", 
      name: "Legacy ERP", 
      x: 0.2, 
      y: 0.3, 
      key_disadvantages: [
        "Expensive on-premise deployments",
        "Complex user interfaces",
        "Limited mobile capabilities",
        "High training requirements"
      ],
      color: theme.palette.grey[500]
    },
    { 
      id: "comp2", 
      name: "Blockchain Startups", 
      x: 0.7, 
      y: 0.4, 
      key_disadvantages: [
        "Lack of industry expertise",
        "Unproven in defense applications",
        "Limited integration capabilities",
        "High technical barriers to adoption"
      ],
      color: theme.palette.warning.main
    },
    { 
      id: "comp3", 
      name: "Traditional SCM", 
      x: 0.4, 
      y: 0.6, 
      key_disadvantages: [
        "Limited traceability capabilities",
        "Weak authentication mechanisms",
        "Poor adaptability to new requirements",
        "Generic solutions not tailored to specific needs"
      ],
      color: theme.palette.info.main
    }
  ];
  
  const marketOpportunities = [
    {
      title: "Defense Sector",
      items: [
        "Military logistics modernization initiatives ($4.2B)",
        "Secure supply chain requirements for sensitive equipment",
        "Coalition interoperability standards compliance",
        "Foreign military sales authentication needs"
      ],
      color: theme.customColors?.militaryAccent || theme.palette.warning.dark
    },
    {
      title: "Commercial Sector",
      items: [
        "High-value retail goods authentication ($2.7B)",
        "Pharmaceutical supply chain compliance",
        "Aerospace parts certification",
        "Luxury goods verification"
      ],
      color: theme.customColors?.commercialAccent || theme.palette.info.main
    }
  ];
  
  const differentiators = [
    {
      title: "Technical Superiority",
      description: "Patentable blockchain verification algorithms with 3x performance improvement",
      icon: "üîê"
    },
    {
      title: "Dual Market Strategy",
      description: "Unique positioning across defense and commercial markets with shared technology",
      icon: "üéØ"
    },
    {
      title: "Domain Expertise",
      description: "Team with combined 35+ years of defense and supply chain experience",
      icon: "üë•"
    },
    {
      title: "Compliance Excellence",
      description: "Built-in compliance with NIST, CMMC, and FDA regulatory requirements",
      icon: "‚úì"
    }
  ];

  return (
    <Slide title="Competitive Landscape">
      <MotionBox
        variants={fadeIn}
        initial="hidden"
        animate="visible"
        sx={{ width: '100%', height: '100%' }}
      >
        <Grid container spacing={3}>
          {/* Competition Matrix */}
          <Grid item xs={12} md={8}>
            <Typography 
              variant="h2" 
              sx={{ 
                fontSize: '1.25rem',
                fontWeight: 600,
                mb: 2,
                fontFamily: '"IBM Plex Mono", monospace',
                textTransform: 'uppercase',
                letterSpacing: 1
              }}
            >
              COMPETITIVE POSITIONING MATRIX_
            </Typography>
            
            <Typography 
              sx={{ 
                fontSize: '0.875rem',
                color: 'text.secondary',
                mb: 3,
                fontFamily: '"IBM Plex Mono", monospace'
              }}
            >
              Analysis based on technical capabilities and market-fit
            </Typography>
            
            <MotionPaper 
              variants={slideUp}
              custom={1}
              elevation={1}
              sx={{ 
                backgroundColor: 'background.paper',
                border: '1px solid',
                borderColor: 'divider',
                borderRadius: 1,
                overflow: 'hidden',
                transition: 'transform 0.2s ease, box-shadow 0.2s ease',
                '&:hover': {
                  transform: 'translateY(-4px)',
                  boxShadow: 6
                }
              }}
            >
              <Box 
                sx={{ 
                  padding: '1rem 1.25rem',
                  display: 'flex',
                  alignItems: 'center',
                  justifyContent: 'space-between',
                  borderBottom: '1px solid',
                  borderColor: 'divider',
                  backgroundColor: 'background.default'
                }}
              >
                <Typography 
                  variant="h3" 
                  sx={{ 
                    fontSize: '1.1rem',
                    fontWeight: 600,
                    fontFamily: '"IBM Plex Mono", monospace',
                    textTransform: 'uppercase',
                    letterSpacing: 1
                  }}
                >
                  TECHNOLOGY vs. MARKET FIT_
                </Typography>
              </Box>
              
              <Box sx={{ padding: 3, position: 'relative' }}>
                <Box 
                  sx={{ 
                    position: 'relative',
                    width: '100%',
                    height: { xs: '300px', md: '400px' },
                    borderLeft: '2px solid',
                    borderBottom: '2px solid',
                    borderColor: 'text.disabled'
                  }}
                >
                  <Box sx={{ position: 'absolute', top: 0, left: 0, right: 0, bottom: 0, zIndex: 0 }}>
                    <HGridLine top="25%" />
                    <HGridLine top="50%" />
                    <HGridLine top="75%" />
                    
                    <VGridLine left="25%" />
                    <VGridLine left="50%" />
                    <VGridLine left="75%" />
                  </Box>
                  
                  {/* X Axis Title */}
                  <Typography 
                    sx={{ 
                      position: 'absolute',
                      bottom: '-50px',
                      left: '50%',
                      transform: 'translateX(-50%)',
                      fontFamily: '"IBM Plex Mono", monospace',
                      fontWeight: 600,
                      fontSize: '0.9rem'
                    }}
                  >
                    TECHNICAL CAPABILITY ‚Üí
                  </Typography>
                  
                  {/* Y Axis Title */}
                  <Typography 
                    sx={{ 
                      position: 'absolute',
                      top: '50%',
                      left: '-50px',
                      transform: 'rotate(-90deg) translateX(50%)',
                      fontFamily: '"IBM Plex Mono", monospace',
                      fontWeight: 600,
                      fontSize: '0.9rem',
                      transformOrigin: 'left center'
                    }}
                  >
                    MARKET FIT ‚Üí
                  </Typography>
                  
                  {/* Quadrant Labels */}
                  <Typography 
                    sx={{ 
                      position: 'absolute',
                      top: '15%',
                      left: '15%',
                      fontFamily: '"IBM Plex Mono", monospace',
                      fontSize: '0.7rem',
                      color: 'text.secondary',
                      opacity: 0.7
                    }}
                  >
                    LOW CAPABILITY / LOW FIT
                  </Typography>
                  
                  <Typography 
                    sx={{ 
                      position: 'absolute',
                      top: '15%',
                      right: '10%',
                      fontFamily: '"IBM Plex Mono", monospace',
                      fontSize: '0.7rem',
                      color: 'text.secondary',
                      opacity: 0.7,
                      textAlign: 'right'
                    }}
                  >
                    HIGH CAPABILITY / LOW FIT
                  </Typography>
                  
                  <Typography 
                    sx={{ 
                      position: 'absolute',
                      bottom: '10%',
                      left: '15%',
                      fontFamily: '"IBM Plex Mono", monospace',
                      fontSize: '0.7rem',
                      color: 'text.secondary',
                      opacity: 0.7
                    }}
                  >
                    LOW CAPABILITY / HIGH FIT
                  </Typography>
                  
                  <Typography 
                    sx={{ 
                      position: 'absolute',
                      bottom: '10%',
                      right: '10%',
                      fontFamily: '"IBM Plex Mono", monospace',
                      fontSize: '0.7rem',
                      color: 'text.secondary',
                      opacity: 0.7,
                      textAlign: 'right'
                    }}
                  >
                    HIGH CAPABILITY / HIGH FIT
                  </Typography>
                  
                  {/* Competitors */}
                  {competitors.map((competitor, index) => (
                    <MotionBox
                      key={competitor.id}
                      variants={slideUp}
                      custom={index + 3}
                      whileHover={{ scale: 1.1 }}
                      sx={{ 
                        position: 'absolute',
                        top: `${(1 - competitor.y) * 100}%`,
                        left: `${competitor.x * 100}%`,
                        transform: 'translate(-50%, -50%)',
                        width: competitor.id === 'us' ? '100px' : '80px',
                        height: competitor.id === 'us' ? '100px' : '80px',
                        borderRadius: '50%',
                        backgroundColor: competitor.color,
                        border: competitor.id === 'us' ? `4px solid ${theme.palette.common.white}` : 'none',
                        display: 'flex',
                        alignItems: 'center',
                        justifyContent: 'center',
                        textAlign: 'center',
                        color: theme.palette.getContrastText(competitor.color),
                        fontWeight: 600,
                        fontSize: '0.8rem',
                        fontFamily: '"IBM Plex Mono", monospace',
                        boxShadow: '0 4px 8px rgba(0,0,0,0.15)',
                        zIndex: competitor.id === 'us' ? 10 : 5,
                        cursor: 'pointer',
                        padding: '8px',
                        lineHeight: 1.2
                      }}
                    >
                      {competitor.name}
                    </MotionBox>
                  ))}
                </Box>
              </Box>
            </MotionPaper>
          </Grid>
          
          {/* Our Advantages */}
          <Grid item xs={12} md={4}>
            <Typography 
              variant="h2" 
              sx={{ 
                fontSize: '1.25rem',
                fontWeight: 600,
                mb: 2,
                fontFamily: '"IBM Plex Mono", monospace',
                textTransform: 'uppercase',
                letterSpacing: 1
              }}
            >
              OUR ADVANTAGES_
            </Typography>
            
            <Box sx={{ backgroundColor: 'rgba(24, 141, 206, 0.05)', borderRadius: 1, p: 2, mb: 3 }}>
              <Typography 
                sx={{ 
                  fontFamily: '"IBM Plex Mono", monospace',
                  color: theme.palette.primary.main,
                  mb: 1,
                  fontWeight: 600
                }}
              >
                KEY ADVANTAGES:
              </Typography>
              
              <Stack spacing={1}>
                {competitors.find(c => c.id === 'us')?.key_advantages?.map((advantage, index) => (
                  <MotionBox
                    key={index}
                    variants={slideUp}
                    custom={index + 5}
                    sx={{ 
                      display: 'flex',
                      alignItems: 'center',
                      gap: 1
                    }}
                  >
                    <Box 
                      sx={{ 
                        width: '8px',
                        height: '8px',
                        backgroundColor: theme.palette.primary.main,
                        flexShrink: 0
                      }}
                    />
                    <Typography variant="body2">
                      {advantage}
                    </Typography>
                  </MotionBox>
                ))}
              </Stack>
            </Box>
            
            <Typography 
              variant="h2" 
              sx={{ 
                fontSize: '1.25rem',
                fontWeight: 600,
                mb: 2,
                fontFamily: '"IBM Plex Mono", monospace',
                textTransform: 'uppercase',
                letterSpacing: 1
              }}
            >
              COMPETITOR WEAKNESSES_
            </Typography>
            
            <MotionPaper
              variants={slideUp}
              custom={9}
              elevation={1}
              sx={{ 
                p: 2,
                backgroundColor: 'background.paper',
                border: '1px solid',
                borderColor: 'divider',
                borderRadius: 1
              }}
            >
              <Stack spacing={1.5}>
                {competitors.filter(c => c.id !== 'us').map((competitor, index) => (
                  <Box key={competitor.id}>
                    <Box 
                      sx={{ 
                        display: 'flex',
                        alignItems: 'center',
                        gap: 1,
                        mb: 0.5
                      }}
                    >
                      <Box 
                        sx={{ 
                          width: '12px',
                          height: '12px',
                          backgroundColor: competitor.color,
                          borderRadius: '50%',
                          flexShrink: 0
                        }}
                      />
                      <Typography 
                        variant="subtitle2" 
                        sx={{ 
                          fontFamily: '"IBM Plex Mono", monospace',
                          fontWeight: 600
                        }}
                      >
                        {competitor.name}
                      </Typography>
                    </Box>
                    
                    <Typography 
                      variant="body2" 
                      sx={{ 
                        color: 'text.secondary',
                        ml: 3,
                        fontSize: '0.8rem'
                      }}
                    >
                      {competitor.key_disadvantages?.[0]}
                    </Typography>
                  </Box>
                ))}
              </Stack>
            </MotionPaper>
          </Grid>
          
          {/* Key Differentiators */}
          <Grid item xs={12}>
            <Typography 
              variant="h2" 
              sx={{ 
                fontSize: '1.25rem',
                fontWeight: 600,
                mb: 2,
                fontFamily: '"IBM Plex Mono", monospace',
                textTransform: 'uppercase',
                letterSpacing: 1
              }}
            >
              KEY DIFFERENTIATORS_
            </Typography>
            
            <Grid container spacing={2}>
              {differentiators.map((diff, index) => (
                <Grid item xs={12} sm={6} md={3} key={index}>
                  <MotionPaper
                    variants={slideUp}
                    custom={index + 10}
                    elevation={0}
                    sx={{ 
                      p: 2,
                      backgroundColor: 'background.default',
                      border: '1px solid',
                      borderColor: 'divider',
                      borderRadius: 1,
                      height: '100%',
                      display: 'flex',
                      flexDirection: 'column'
                    }}
                  >
                    <Box 
                      sx={{ 
                        display: 'flex',
                        alignItems: 'center',
                        gap: 1,
                        mb: 1
                      }}
                    >
                      <Box sx={{ fontSize: '1.5rem' }}>{diff.icon}</Box>
                      <Typography 
                        variant="subtitle1" 
                        sx={{ 
                          fontFamily: '"IBM Plex Mono", monospace',
                          fontWeight: 600,
                          fontSize: '0.9rem'
                        }}
                      >
                        {diff.title}
                      </Typography>
                    </Box>
                    
                    <Typography variant="body2" sx={{ color: 'text.secondary', fontSize: '0.85rem' }}>
                      {diff.description}
                    </Typography>
                  </MotionPaper>
                </Grid>
              ))}
            </Grid>
          </Grid>
          
          {/* Market Opportunities */}
          <Grid item xs={12}>
            <Typography 
              variant="h2" 
              sx={{ 
                fontSize: '1.25rem',
                fontWeight: 600,
                mb: 2,
                fontFamily: '"IBM Plex Mono", monospace',
                textTransform: 'uppercase',
                letterSpacing: 1
              }}
            >
              MARKET OPPORTUNITIES_
            </Typography>
            
            <Grid container spacing={2}>
              {marketOpportunities.map((opportunity, index) => (
                <Grid item xs={12} md={6} key={index}>
                  <MotionPaper
                    variants={slideUp}
                    custom={index + 14}
                    elevation={1}
                    sx={{ 
                      p: 2,
                      backgroundColor: 'background.paper',
                      borderRadius: 1,
                      borderTop: '4px solid',
                      borderColor: opportunity.color
                    }}
                  >
                    <Typography 
                      variant="h6" 
                      sx={{ 
                        mb: 2,
                        fontFamily: '"IBM Plex Mono", monospace',
                        fontWeight: 600,
                        color: opportunity.color
                      }}
                    >
                      {opportunity.title}
                    </Typography>
                    
                    <Stack spacing={1}>
                      {opportunity.items.map((item, idx) => (
                        <Box 
                          key={idx}
                          sx={{ 
                            display: 'flex',
                            alignItems: 'flex-start',
                            gap: 1
                          }}
                        >
                          <Box 
                            sx={{ 
                              color: opportunity.color,
                              mt: 0.3,
                              fontWeight: 'bold',
                              fontSize: '0.8rem'
                            }}
                          >
                            ‚Ä∫
                          </Box>
                          <Typography variant="body2">
                            {item}
                          </Typography>
                        </Box>
                      ))}
                    </Stack>
                  </MotionPaper>
                </Grid>
              ))}
            </Grid>
          </Grid>
        </Grid>
      </MotionBox>
    </Slide>
  );
};

export default CompetitiveLandscape; 